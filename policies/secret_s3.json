{
    "Version": "2012-10-17",
    "Id": "123",
    "Statement": [
      {
        "Sid": "DenyMFA",
        "Effect": "Deny",
        "Principal": "*",
        "Action": "s3:*",
        "Resource": [
          "arn:aws:s3:::${bucket_name}/*", 
          "arn:aws:s3:::${bucket_name}"
        ],
        "Condition": { "Null": { "aws:MultiFactorAuthAge": true }}
      },
      {
        "Sid": "DenyMFAage",
        "Effect": "Deny",
        "Principal": "*",
        "Action": "s3:*",
        "Resource": [
          "arn:aws:s3:::${bucket_name}/*", 
          "arn:aws:s3:::${bucket_name}"
        ],
        "Condition": {"NumericGreaterThan": {"aws:MultiFactorAuthAge": ${mfa_period} }}
      },
      {
            "Sid": "DenyUntrsuted",
            "Effect": "Deny",
            "Principal": "*",
            "Action": [
                "s3:*"
            ],
            "Resource": [
                "arn:aws:s3:::${bucket_name}",
                "arn:aws:s3:::${bucket_name}/*"
            ],
            "Condition": {
                "StringNotEquals": {
                    "aws:sourceVpce": ${vpc_endpoint_ids}
                },
                "StringNotLike": {
                  "aws:userId": ${trusted_role_ids}
                }
            }
        }
    ]
 }